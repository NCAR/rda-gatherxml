BootStrap: localimage
From: /glade/u/home/rdadata/lib/singularity/gatherxml-1-os.sif

%post
    apt-get install -y software-properties-common dirmngr apt-transport-https
    apt-key adv --fetch-keys 'https://mariadb.org/mariadb_release_signing_key.asc'
    add-apt-repository 'deb [arch=amd64,arm64,ppc64el,s390x] https://mirrors.gigenet.com/mariadb/repo/10.3/ubuntu focal main'
    apt-get update -y
    apt-get install -y libmariadbclient-dev
    apt-get install -y libssl-dev
    apt-get install -y rsync
    apt-get install -y openssh-client
    apt-get install -y libcurl4-openssl-dev
    apt-get install -y curl
    apt-get install -y cmake
#
# build jasper library from source
    cd / \
      && curl -L -O https://github.com/jasper-software/jasper/archive/version-2.0.33/jasper-2.0.33.tar.gz \
      && tar xvf jasper-2.0.33.tar.gz \
      && rm jasper-2.0.33.tar.gz \
      && cd jasper-version-2.0.33/build \
      && cmake -G "Unix Makefiles" -H/jasper-version-2.0.33 -B/jasper-version-2.0.33/build -DCMAKE_INSTALL_PREFIX=/usr/lib/x86_64-linux-gnu \
      && make install \
      && make clean

%environment
    export LC_ALL=C

%runscript

%labels
    Author dattore@ucar.edu
